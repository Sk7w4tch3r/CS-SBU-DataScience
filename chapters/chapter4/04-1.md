---
layout: default
title: Data Wrangling
lang-ref: chapter4.1
---

# Data Wrangling

The process of turning raw data into more appropriate format. in the end, the result should have acceptable [Data Quality](https://en.wikipedia.org/wiki/Data_quality).

### Contents included in this notebook:
   * Data Exploration
   * Data Cleaning 
   * Merging Datasets
   

Also this notebook will introduce you to [Pandas](https://pandas.pydata.org/) which faciliate the manipulation task.

### Datasets:
   * [Samsung after-sales service in Iran](https://www.kaggle.com/sinatavakolibanizi/samsung-aftersales-service-in-iran)
   * [Iran's Earthquakes through history](https://www.kaggle.com/mehrdat/irans-earthquakes)
   


```python
from os.path import join
import numpy as np
import pandas as pd
%pdb 1
```

    Automatic pdb calling has been turned ON


## Samsung after-sales service in Iran

### Data Exploration

The purpose of this part is to gain a better understanding of the data. what's data is about? what's the structure? what's the values? ... 

Let's read Iran's Earthquakes dataset into a [DataFrame](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html).


```python
service_df = pd.read_csv(join('Datasets', 'service', 'samdata.csv'))
service_df
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>Serial_No</th>
      <th>City</th>
      <th>Product_Date</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>AUDIO - HOME THEAT</td>
      <td>2F/LAHFZ7E-IP-X</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>2/5/2012</td>
      <td>2/5/2012</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>351</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>AIP244AACA/4E7</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>7/7/2012</td>
      <td>9/10/2012</td>
      <td>1/31/2013</td>
      <td>65</td>
      <td>208</td>
      <td>1</td>
      <td>SHORT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>3437481.60</td>
      <td>687486.320</td>
      <td>2748885.280</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>JK-C4BBCAEKL72</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>7/7/2012</td>
      <td>8/15/2012</td>
      <td>1/31/2013</td>
      <td>38</td>
      <td>208</td>
      <td>1</td>
      <td>OPEN</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>4228756.56</td>
      <td>845751.312</td>
      <td>3383005.248</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>IP2JO4/-A-47</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>8/7/2012</td>
      <td>8/7/2012</td>
      <td>1/13/2013</td>
      <td>0</td>
      <td>158</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>AUDIO - MP3 Player</td>
      <td>AU/BCQE2A/P</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>8/7/2012</td>
      <td>8/9/2012</td>
      <td>1/7/2013</td>
      <td>2</td>
      <td>153</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Medium</td>
      <td>Tech07</td>
      <td>120000</td>
      <td>765488.60</td>
      <td>177087.820</td>
      <td>708381.680</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3131</th>
      <td>3132</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LCD-40</td>
      <td>IP2JRIP/QE2KLKL</td>
      <td>REZVANSHAHR</td>
      <td>NaN</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420000</td>
      <td>0.00</td>
      <td>84000.000</td>
      <td>336000.000</td>
    </tr>
    <tr>
      <th>3132</th>
      <td>3133</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LED46</td>
      <td>IP2JRC/&amp;/2/IP</td>
      <td>ESFAHAN</td>
      <td>NaN</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420000</td>
      <td>0.00</td>
      <td>84000.000</td>
      <td>336000.000</td>
    </tr>
    <tr>
      <th>3133</th>
      <td>3134</td>
      <td>0</td>
      <td>Extended Warranty</td>
      <td>HARD DISK DRIVE</td>
      <td>S2/BJ2/B2KL4Z2</td>
      <td>Tehran</td>
      <td>40552.0</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Minimum</td>
      <td>Tech07</td>
      <td>50000</td>
      <td>0.00</td>
      <td>10000.000</td>
      <td>40000.000</td>
    </tr>
    <tr>
      <th>3134</th>
      <td>3135</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>HARD DISK DRIVE</td>
      <td>S2/BJ2/SC2/QE2</td>
      <td>Tehran</td>
      <td>38825.0</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Free Of Charge</td>
      <td>Tech07</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3135</th>
      <td>3136</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DVD PLAYER/ RECORD</td>
      <td>A&amp;QEKLCDQAEA7AZ</td>
      <td>Tehran</td>
      <td>38448.0</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech18</td>
      <td>150000</td>
      <td>1488482.00</td>
      <td>328686.400</td>
      <td>1318785.600</td>
    </tr>
  </tbody>
</table>
<p>3136 rows × 22 columns</p>
</div>



```shape``` attribute indicate how large the resulting DataFrame is.


```python
service_df.shape
```




    (3136, 22)




```python
print("pandas only displays " + str(pd.options.display.max_rows) + " rows" ) 
print("and " + str(pd.options.display.max_columns) + " columns at max by default" ) 
```

    pandas only displays 60 rows
    and None columns at max by default


The size of the dataset is not that big and beside that, it only have 2 more columns than pandas maximum displayed columns. so let's tell pandas to show all columns for convenience.


```python
 pd.set_option('display.max_columns', None)
```

use ```loc()``` and ```iloc()``` for selecting rows in specific range.


```python
service_df.iloc[26:33:3]
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>Serial_No</th>
      <th>City</th>
      <th>Product_Date</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>27</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>DIGITAL CAMERA</td>
      <td>AAKLMCN/CIPE/GT</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>11/22/2012</td>
      <td>11/22/2012</td>
      <td>1/26/2013</td>
      <td>0</td>
      <td>65</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>OUTCASE CRACK</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech11</td>
      <td>250000</td>
      <td>0.0</td>
      <td>50000.0</td>
      <td>200000.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>30</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>TFT18</td>
      <td>H2MQ2/2/472</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>12/1/2012</td>
      <td>12/1/2012</td>
      <td>1/6/2013</td>
      <td>0</td>
      <td>36</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>33</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>TFT18</td>
      <td>H2MQ2/AE27</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>12/2/2012</td>
      <td>12/2/2012</td>
      <td>1/6/2013</td>
      <td>0</td>
      <td>35</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>NO POWER</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```sample()``` returns random rows to look at.


```python
service_df.sample(13)
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>Serial_No</th>
      <th>City</th>
      <th>Product_Date</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>131</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LED40</td>
      <td>IP2JQC/KLIP2IPIP</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>12/18/2012</td>
      <td>12/18/2012</td>
      <td>1/30/2013</td>
      <td>0</td>
      <td>43</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>NO PICTURE/NO RASTER</td>
      <td>SET EXCHANGE</td>
      <td>Free Of Charge</td>
      <td>Tech23</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1807</th>
      <td>1808</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>H2MPA/2KL74/</td>
      <td>Tehran</td>
      <td>38083.0</td>
      <td>1/13/2013</td>
      <td>1/14/2013</td>
      <td>1/23/2013</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2971</th>
      <td>2972</td>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>LED40</td>
      <td>IP2JQA/&amp;427A</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/27/2013</td>
      <td>1/27/2013</td>
      <td>1/28/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech15</td>
      <td>420000</td>
      <td>14086824.28</td>
      <td>2803384.856</td>
      <td>1.161354e+07</td>
    </tr>
    <tr>
      <th>3043</th>
      <td>3044</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DIGITAL CAMERA</td>
      <td>AAKLMCN/CAE/LAJ</td>
      <td>Tehran</td>
      <td>40808.0</td>
      <td>1/28/2013</td>
      <td>1/28/2013</td>
      <td>1/30/2013</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech11</td>
      <td>250000</td>
      <td>584648.70</td>
      <td>166828.740</td>
      <td>6.677189e+05</td>
    </tr>
    <tr>
      <th>2331</th>
      <td>2332</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LCD-40</td>
      <td>IP2JRA/72A/KL</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/20/2013</td>
      <td>1/20/2013</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SET EXCHANGE</td>
      <td>Free Of Charge</td>
      <td>Tech14</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>101</th>
      <td>102</td>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>H2MM2/A/4IPKL</td>
      <td>Tehran</td>
      <td>38081.0</td>
      <td>12/16/2012</td>
      <td>12/17/2012</td>
      <td>1/5/2013</td>
      <td>1</td>
      <td>20</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>3096</th>
      <td>3097</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LED40</td>
      <td>IP2JQA/&amp;KL/4/</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/28/2013</td>
      <td>1/28/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>NO PICTURE/NO RASTER</td>
      <td>SET EXCHANGE</td>
      <td>Free Of Charge</td>
      <td>Tech23</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2181</th>
      <td>2182</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>DVD PLAYER</td>
      <td>ZT2QARDBC/2&amp;IP2Z</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/19/2013</td>
      <td>1/19/2013</td>
      <td>1/20/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech18</td>
      <td>170000</td>
      <td>1840063.68</td>
      <td>402012.736</td>
      <td>1.608051e+06</td>
    </tr>
    <tr>
      <th>2141</th>
      <td>2142</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LED40</td>
      <td>IP2JQA/&amp;QE4/</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/19/2013</td>
      <td>1/19/2013</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech14</td>
      <td>215000</td>
      <td>0.00</td>
      <td>43000.000</td>
      <td>1.720000e+05</td>
    </tr>
    <tr>
      <th>935</th>
      <td>936</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LCD-40</td>
      <td>IP2JRA/7/7&amp;IP</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/5/2013</td>
      <td>1/5/2013</td>
      <td>1/6/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SET EXCHANGE</td>
      <td>Free Of Charge</td>
      <td>Tech08</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1698</th>
      <td>1699</td>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LCD-40</td>
      <td>IP2JQA/&amp;2772</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/10/2013</td>
      <td>1/19/2013</td>
      <td>1/20/2013</td>
      <td>8</td>
      <td>10</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SET EXCHANGE</td>
      <td>Free Of Charge</td>
      <td>Tech13</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>343</th>
      <td>344</td>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>LED40</td>
      <td>IP2JR2/-2/IP4</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>12/27/2012</td>
      <td>12/31/2012</td>
      <td>1/1/2013</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech10</td>
      <td>420000</td>
      <td>24887810.32</td>
      <td>5063582.064</td>
      <td>2.025433e+07</td>
    </tr>
    <tr>
      <th>1875</th>
      <td>1876</td>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>LCD- 46</td>
      <td>IP2JQ7/42/42</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/14/2013</td>
      <td>1/17/2013</td>
      <td>1/20/2013</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>



Dataset itself have a column for index values, let's be sure that it's really unique for each row, then we can condiser *```No``` column* as index.


```python
service_df['No'].is_unique
```




    True




```python
service_df.set_index("No", inplace=True)
```

```head(n)``` returns first *n* rows.
```tail(n)``` returns last *n* rows.
Default value is considered to be 5.


```python
service_df.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>Serial_No</th>
      <th>City</th>
      <th>Product_Date</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>AUDIO - HOME THEAT</td>
      <td>2F/LAHFZ7E-IP-X</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>2/5/2012</td>
      <td>2/5/2012</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>351</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>AIP244AACA/4E7</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>7/7/2012</td>
      <td>9/10/2012</td>
      <td>1/31/2013</td>
      <td>65</td>
      <td>208</td>
      <td>1</td>
      <td>SHORT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>3437481.60</td>
      <td>687486.320</td>
      <td>2748885.280</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>JK-C4BBCAEKL72</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>7/7/2012</td>
      <td>8/15/2012</td>
      <td>1/31/2013</td>
      <td>38</td>
      <td>208</td>
      <td>1</td>
      <td>OPEN</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>4228756.56</td>
      <td>845751.312</td>
      <td>3383005.248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>IP2JO4/-A-47</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>8/7/2012</td>
      <td>8/7/2012</td>
      <td>1/13/2013</td>
      <td>0</td>
      <td>158</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>AUDIO - MP3 Player</td>
      <td>AU/BCQE2A/P</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>8/7/2012</td>
      <td>8/9/2012</td>
      <td>1/7/2013</td>
      <td>2</td>
      <td>153</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Medium</td>
      <td>Tech07</td>
      <td>120000</td>
      <td>765488.60</td>
      <td>177087.820</td>
      <td>708381.680</td>
    </tr>
  </tbody>
</table>
</div>



```Columns``` attribute returns all column names.


```python
service_df.columns
```




    Index(['Service_type', 'Cost_Type', 'Product_Group', 'Serial_No', 'City',
           'Product_Date', 'Receipt_Date', 'Appoint_Date', 'Complete_Date',
           'TAT01', 'TAT02', 'Job_Satus', 'Defect_Des', 'Symptom_Desc',
           'Repair_Action_Desc', 'Labor_Charge_Desc', 'Engineer',
           'Labor_Charge_Amount', 'Parts_Amount', 'Discount_Amount',
           'Total_Invoice_Amount'],
          dtype='object')



```dtypes``` shows each column data type.


```python
service_df.dtypes
```




    Service_type              int64
    Cost_Type                object
    Product_Group            object
    Serial_No                object
    City                     object
    Product_Date            float64
    Receipt_Date             object
    Appoint_Date             object
    Complete_Date            object
    TAT01                     int64
    TAT02                     int64
    Job_Satus                 int64
    Defect_Des               object
    Symptom_Desc             object
    Repair_Action_Desc       object
    Labor_Charge_Desc        object
    Engineer                 object
    Labor_Charge_Amount       int64
    Parts_Amount            float64
    Discount_Amount         float64
    Total_Invoice_Amount    float64
    dtype: object



```info()``` function summarise the dadaset. 


```python
service_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 3136 entries, 1 to 3136
    Data columns (total 21 columns):
     #   Column                Non-Null Count  Dtype  
    ---  ------                --------------  -----  
     0   Service_type          3136 non-null   int64  
     1   Cost_Type             3136 non-null   object 
     2   Product_Group         3126 non-null   object 
     3   Serial_No             3127 non-null   object 
     4   City                  3136 non-null   object 
     5   Product_Date          724 non-null    float64
     6   Receipt_Date          3136 non-null   object 
     7   Appoint_Date          3136 non-null   object 
     8   Complete_Date         3136 non-null   object 
     9   TAT01                 3136 non-null   int64  
     10  TAT02                 3136 non-null   int64  
     11  Job_Satus             3136 non-null   int64  
     12  Defect_Des            3136 non-null   object 
     13  Symptom_Desc          3136 non-null   object 
     14  Repair_Action_Desc    3136 non-null   object 
     15  Labor_Charge_Desc     3136 non-null   object 
     16  Engineer              3136 non-null   object 
     17  Labor_Charge_Amount   3136 non-null   int64  
     18  Parts_Amount          3136 non-null   float64
     19  Discount_Amount       3136 non-null   float64
     20  Total_Invoice_Amount  3136 non-null   float64
    dtypes: float64(4), int64(5), object(12)
    memory usage: 539.0+ KB


For numerical values ```describe()``` function shows statical features of each column.


```python
service_df.describe()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Product_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3136.000000</td>
      <td>724.000000</td>
      <td>3136.000000</td>
      <td>3136.000000</td>
      <td>3136.000000</td>
      <td>3136.000000</td>
      <td>3.136000e+03</td>
      <td>3.136000e+03</td>
      <td>3.136000e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.105230</td>
      <td>39227.758287</td>
      <td>1.289222</td>
      <td>6.647959</td>
      <td>0.977360</td>
      <td>129877.232143</td>
      <td>2.303481e+06</td>
      <td>4.844214e+05</td>
      <td>1.924006e+06</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.306898</td>
      <td>1152.746282</td>
      <td>5.060422</td>
      <td>14.012700</td>
      <td>0.148778</td>
      <td>176843.065376</td>
      <td>6.682868e+06</td>
      <td>1.349372e+06</td>
      <td>5.400547e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>33870.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>38451.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>38823.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>40188.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>250000.000000</td>
      <td>7.510464e+04</td>
      <td>8.738318e+04</td>
      <td>3.827746e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>40813.000000</td>
      <td>81.000000</td>
      <td>351.000000</td>
      <td>1.000000</td>
      <td>540000.000000</td>
      <td>4.480716e+07</td>
      <td>8.088432e+06</td>
      <td>3.635773e+07</td>
    </tr>
  </tbody>
</table>
</div>



Columns can be accessed as a attribute to the dataframe. Each column in fact is a [Series](https://pandas.pydata.org/docs/reference/series.html). we can count each repetative value by using ```value_count()``` function.


```python
service_df.Product_Group.value_counts()
```




    LED40                 1008
    LCD-40                 529
    DIGITAL CAMERA         282
    LED46                  250
    PRINTER - MONO LAS     151
    DVD PLAYER             119
    AUDIO - MP3 Player     109
    HARD DISK DRIVE        102
    AUDIO - HOME THEAT     102
    REFRIGERATOR-SBS        68
    DVD PLAYER/ RECORD      65
    PLASMA-42               62
    CAMCORDER               57
    PLASMA-43               49
    PRINTER - COLOR LA      35
    MONITOR - TFT LCD       24
    VACUUM CLEANER          24
    TFT18                   18
    WASHING MACHINE         16
    PLASMA-51               15
    LED55                   15
    OVEN - MICROWAVE        11
    LCD- 46                  8
    PLASMA-50                4
    AIR CONDITIONER          3
    Name: Product_Group, dtype: int64



Also we can group rows by columns. and get each group size.


```python
service_df.groupby(by =["Product_Group", "Cost_Type"]).size()
```




    Product_Group       Cost_Type        
    AIR CONDITIONER     Normal Warranty         2
                        Out of Warranty         1
    AUDIO - HOME THEAT  Normal Warranty         3
                        Out of Warranty        99
    AUDIO - MP3 Player  Normal Warranty        28
                        Out of Warranty        81
    CAMCORDER           Normal Warranty         5
                        Out of Warranty        52
    DIGITAL CAMERA      Normal Warranty       149
                        Out of Warranty       133
    DVD PLAYER          Normal Warranty        53
                        Out of Warranty        66
    DVD PLAYER/ RECORD  Extended Warranty      11
                        Normal Warranty        18
                        Out of Warranty        36
    HARD DISK DRIVE     Extended Warranty      63
                        Normal Warranty        14
                        Out of Warranty        25
    LCD- 46             Normal Warranty         5
                        Out of Warranty         3
    LCD-40              Normal Warranty       522
                        Out of Warranty         7
    LED40               Normal Warranty      1003
                        Out of Warranty         5
    LED46               Normal Warranty       247
                        Out of Warranty         3
    LED55               Normal Warranty        14
                        Out of Warranty         1
    MONITOR - TFT LCD   Normal Warranty         5
                        Out of Warranty        19
    OVEN - MICROWAVE    Normal Warranty         3
                        Out of Warranty         8
    PLASMA-42           Normal Warranty        55
                        Out of Warranty         7
    PLASMA-43           Normal Warranty        45
                        Out of Warranty         4
    PLASMA-50           Normal Warranty         3
                        Out of Warranty         1
    PLASMA-51           Normal Warranty        12
                        Out of Warranty         3
    PRINTER - COLOR LA  Normal Warranty        14
                        Out of Warranty        21
    PRINTER - MONO LAS  Normal Warranty        57
                        Out of Warranty        94
    REFRIGERATOR-SBS    Normal Warranty        32
                        Out of Warranty        36
    TFT18               Extended Warranty       2
                        Normal Warranty        15
                        Out of Warranty         1
    VACUUM CLEANER      Normal Warranty         1
                        Out of Warranty        23
    WASHING MACHINE     Out of Warranty        16
    dtype: int64



In fact the result of above command is a Series which have [multiple indexes](https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html). by using ```unstack()```, we reshape the series into a Dataframe


```python
service_df.groupby(by =["Product_Group", "Cost_Type"]).size().unstack()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Cost_Type</th>
      <th>Extended Warranty</th>
      <th>Normal Warranty</th>
      <th>Out of Warranty</th>
    </tr>
    <tr>
      <th>Product_Group</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AIR CONDITIONER</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>AUDIO - HOME THEAT</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>AUDIO - MP3 Player</th>
      <td>NaN</td>
      <td>28.0</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>CAMCORDER</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>52.0</td>
    </tr>
    <tr>
      <th>DIGITAL CAMERA</th>
      <td>NaN</td>
      <td>149.0</td>
      <td>133.0</td>
    </tr>
    <tr>
      <th>DVD PLAYER</th>
      <td>NaN</td>
      <td>53.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>DVD PLAYER/ RECORD</th>
      <td>11.0</td>
      <td>18.0</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>HARD DISK DRIVE</th>
      <td>63.0</td>
      <td>14.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>LCD- 46</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>LCD-40</th>
      <td>NaN</td>
      <td>522.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>LED40</th>
      <td>NaN</td>
      <td>1003.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>LED46</th>
      <td>NaN</td>
      <td>247.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>LED55</th>
      <td>NaN</td>
      <td>14.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>MONITOR - TFT LCD</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>OVEN - MICROWAVE</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>PLASMA-42</th>
      <td>NaN</td>
      <td>55.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>PLASMA-43</th>
      <td>NaN</td>
      <td>45.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>PLASMA-50</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>PLASMA-51</th>
      <td>NaN</td>
      <td>12.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>PRINTER - COLOR LA</th>
      <td>NaN</td>
      <td>14.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>PRINTER - MONO LAS</th>
      <td>NaN</td>
      <td>57.0</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>REFRIGERATOR-SBS</th>
      <td>NaN</td>
      <td>32.0</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>TFT18</th>
      <td>2.0</td>
      <td>15.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>VACUUM CLEANER</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>WASHING MACHINE</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
</div>



let's count NaN values in each columns. 


```python
service_df.isna().sum()
```




    Service_type               0
    Cost_Type                  0
    Product_Group             10
    Serial_No                  9
    City                       0
    Product_Date            2412
    Receipt_Date               0
    Appoint_Date               0
    Complete_Date              0
    TAT01                      0
    TAT02                      0
    Job_Satus                  0
    Defect_Des                 0
    Symptom_Desc               0
    Repair_Action_Desc         0
    Labor_Charge_Desc          0
    Engineer                   0
    Labor_Charge_Amount        0
    Parts_Amount               0
    Discount_Amount            0
    Total_Invoice_Amount       0
    dtype: int64



let's see rows with NaN values


```python
service_df[service_df[['Product_Group','Serial_No']].isna().any(1)]
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>Serial_No</th>
      <th>City</th>
      <th>Product_Date</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>412</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>2P-/BAXS-E/KLKLK</td>
      <td>Tehran</td>
      <td>38818.0</td>
      <td>12/29/2012</td>
      <td>12/31/2012</td>
      <td>1/8/2013</td>
      <td>2</td>
      <td>10</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>542</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>PRINTER - MONO LAS</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>12/31/2012</td>
      <td>12/31/2012</td>
      <td>1/1/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Maximum</td>
      <td>Tech20</td>
      <td>350000</td>
      <td>0.00</td>
      <td>70000.000</td>
      <td>280000.000</td>
    </tr>
    <tr>
      <th>626</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>ZADCKLVKSAE2KL2K</td>
      <td>MASHHAD</td>
      <td>38814.0</td>
      <td>1/1/2013</td>
      <td>1/8/2013</td>
      <td>1/13/2013</td>
      <td>7</td>
      <td>12</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>Test OK</td>
      <td>No Action</td>
      <td>Free Of Charge</td>
      <td>Tech08</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>704</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>A/&amp;2GV2B&amp;E/KL2K</td>
      <td>Tehran</td>
      <td>40548.0</td>
      <td>1/1/2013</td>
      <td>1/2/2013</td>
      <td>1/5/2013</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>Software Bug</td>
      <td>ZOOM PROBLEM</td>
      <td>FIRMWARE UPGRADE</td>
      <td>Major</td>
      <td>Tech08</td>
      <td>250000</td>
      <td>0.00</td>
      <td>50000.000</td>
      <td>200000.000</td>
    </tr>
    <tr>
      <th>876</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>VACUUM CLEANER</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/2/2013</td>
      <td>1/6/2013</td>
      <td>1/6/2013</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech17</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>934</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ZTAPKLCABA/2IP24L</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/5/2013</td>
      <td>1/5/2013</td>
      <td>1/5/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1059</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ZTAPKLCIBAE&amp;&amp;/D</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/5/2013</td>
      <td>1/6/2013</td>
      <td>1/7/2013</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Medium</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ZTAPKLCIBB/&amp;IP47A</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/6/2013</td>
      <td>1/6/2013</td>
      <td>1/10/2013</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech14</td>
      <td>170000</td>
      <td>1158705.72</td>
      <td>265741.144</td>
      <td>1062864.576</td>
    </tr>
    <tr>
      <th>1213</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>2P7IPBAKPQEKL27/N</td>
      <td>Tehran</td>
      <td>38080.0</td>
      <td>1/6/2013</td>
      <td>1/6/2013</td>
      <td>1/7/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>Test OK</td>
      <td>No Action</td>
      <td>Free Of Charge</td>
      <td>Tech20</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>1235</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>VACUUM CLEANER</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/6/2013</td>
      <td>1/8/2013</td>
      <td>1/9/2013</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech17</td>
      <td>145000</td>
      <td>15526.44</td>
      <td>32105.288</td>
      <td>128421.152</td>
    </tr>
    <tr>
      <th>1550</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ZTAPKLCIB2/A/7KLZ</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Medium</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1571</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ZTAPKLCIBA/A4QEP</td>
      <td>ARDEBIL</td>
      <td>NaN</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>1/27/2013</td>
      <td>0</td>
      <td>18</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech18</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>1617</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>A/&amp;KLKLVBB&amp;E/2AN</td>
      <td>Tehran</td>
      <td>40548.0</td>
      <td>1/9/2013</td>
      <td>1/10/2013</td>
      <td>1/13/2013</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>NO POWER</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech08</td>
      <td>250000</td>
      <td>0.00</td>
      <td>50000.000</td>
      <td>200000.000</td>
    </tr>
    <tr>
      <th>1814</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DVD PLAYER</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/14/2013</td>
      <td>1/14/2013</td>
      <td>1/26/2013</td>
      <td>0</td>
      <td>12</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech14</td>
      <td>120000</td>
      <td>868118.56</td>
      <td>187823.812</td>
      <td>781285.648</td>
    </tr>
    <tr>
      <th>2032</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DIGITAL CAMERA</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/15/2013</td>
      <td>1/15/2013</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>OTHER PROBLEMS</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech11</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>2036</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>VACUUM CLEANER</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/16/2013</td>
      <td>1/20/2013</td>
      <td>1/20/2013</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech17</td>
      <td>0</td>
      <td>18858.40</td>
      <td>3871.880</td>
      <td>15887.520</td>
    </tr>
    <tr>
      <th>2269</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>AUDIO - HOME THEAT</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/20/2013</td>
      <td>1/20/2013</td>
      <td>1/20/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech18</td>
      <td>0</td>
      <td>1450087.28</td>
      <td>280018.456</td>
      <td>1160077.824</td>
    </tr>
    <tr>
      <th>2772</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DVD PLAYER</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>NaN</td>
      <td>1/24/2013</td>
      <td>1/24/2013</td>
      <td>1/26/2013</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Minimum</td>
      <td>Tech18</td>
      <td>70000</td>
      <td>868118.56</td>
      <td>187823.812</td>
      <td>751285.648</td>
    </tr>
    <tr>
      <th>2892</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DIGITAL CAMERA</td>
      <td>NaN</td>
      <td>ABHAR</td>
      <td>NaN</td>
      <td>1/27/2013</td>
      <td>1/27/2013</td>
      <td>1/28/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>OTHER PROBLEMS</td>
      <td>SCRAP</td>
      <td>Free Of Charge</td>
      <td>Tech11</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
</div>



### Data Cleaning

In this part, based on what we want to do with the data, we restructure, reformat and validate the data.


for start, let's remove columns that's not useful for our hypothetical purpose.

 * Does *```Serial_No```* really help the model to decide how much time it takes to be repaired?
 * or is *```Product_Date```* values meaningful?

 if the answers to these questions are No, we can drop those columns. 
 


```python
service_df = service_df.drop(columns=['Product_Date', 'Serial_No'])
service_df
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>City</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>AUDIO - HOME THEAT</td>
      <td>Tehran</td>
      <td>2/5/2012</td>
      <td>2/5/2012</td>
      <td>1/21/2013</td>
      <td>0</td>
      <td>351</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>Tehran</td>
      <td>7/7/2012</td>
      <td>9/10/2012</td>
      <td>1/31/2013</td>
      <td>65</td>
      <td>208</td>
      <td>1</td>
      <td>SHORT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>3437481.60</td>
      <td>687486.320</td>
      <td>2748885.280</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>Tehran</td>
      <td>7/7/2012</td>
      <td>8/15/2012</td>
      <td>1/31/2013</td>
      <td>38</td>
      <td>208</td>
      <td>1</td>
      <td>OPEN</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0</td>
      <td>4228756.56</td>
      <td>845751.312</td>
      <td>3383005.248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>Tehran</td>
      <td>8/7/2012</td>
      <td>8/7/2012</td>
      <td>1/13/2013</td>
      <td>0</td>
      <td>158</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>AUDIO - MP3 Player</td>
      <td>Tehran</td>
      <td>8/7/2012</td>
      <td>8/9/2012</td>
      <td>1/7/2013</td>
      <td>2</td>
      <td>153</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Medium</td>
      <td>Tech07</td>
      <td>120000</td>
      <td>765488.60</td>
      <td>177087.820</td>
      <td>708381.680</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3132</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LCD-40</td>
      <td>REZVANSHAHR</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420000</td>
      <td>0.00</td>
      <td>84000.000</td>
      <td>336000.000</td>
    </tr>
    <tr>
      <th>3133</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>LED46</td>
      <td>ESFAHAN</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420000</td>
      <td>0.00</td>
      <td>84000.000</td>
      <td>336000.000</td>
    </tr>
    <tr>
      <th>3134</th>
      <td>0</td>
      <td>Extended Warranty</td>
      <td>HARD DISK DRIVE</td>
      <td>Tehran</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Minimum</td>
      <td>Tech07</td>
      <td>50000</td>
      <td>0.00</td>
      <td>10000.000</td>
      <td>40000.000</td>
    </tr>
    <tr>
      <th>3135</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>HARD DISK DRIVE</td>
      <td>Tehran</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Free Of Charge</td>
      <td>Tech07</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3136</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>DVD PLAYER/ RECORD</td>
      <td>Tehran</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>1/31/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech18</td>
      <td>150000</td>
      <td>1488482.00</td>
      <td>328686.400</td>
      <td>1318785.600</td>
    </tr>
  </tbody>
</table>
<p>3136 rows × 19 columns</p>
</div>



Dataset at hand have some NaN values. what does it mean? is it that the value exist but not provided or there isn't anything to fill that field?

possible solutions

* drop data
    - drop the whole row
    - drop the whole column
* [Imputation](https://en.wikipedia.org/wiki/Imputation_(statistics))
    - replace it by mean
    - replace it by frequency
    - adding unkown category
    - ...

it's important to have a logical reason. it's not reasonable to fill NaN values with mean when NaN occupies half of that column.

Where's the NaN values ?


```python
service_df.isna().sum()
```




    Service_type             0
    Cost_Type                0
    Product_Group           10
    City                     0
    Receipt_Date             0
    Appoint_Date             0
    Complete_Date            0
    TAT01                    0
    TAT02                    0
    Job_Satus                0
    Defect_Des               0
    Symptom_Desc             0
    Repair_Action_Desc       0
    Labor_Charge_Desc        0
    Engineer                 0
    Labor_Charge_Amount      0
    Parts_Amount             0
    Discount_Amount          0
    Total_Invoice_Amount     0
    dtype: int64



Let's see rows with NaN values.


```python
service_df[pd.isna(service_df.Product_Group)]
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>City</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>412</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>12/29/2012</td>
      <td>12/31/2012</td>
      <td>1/8/2013</td>
      <td>2</td>
      <td>10</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech16</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>626</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>MASHHAD</td>
      <td>1/1/2013</td>
      <td>1/8/2013</td>
      <td>1/13/2013</td>
      <td>7</td>
      <td>12</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>Test OK</td>
      <td>No Action</td>
      <td>Free Of Charge</td>
      <td>Tech08</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>704</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/1/2013</td>
      <td>1/2/2013</td>
      <td>1/5/2013</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>Software Bug</td>
      <td>ZOOM PROBLEM</td>
      <td>FIRMWARE UPGRADE</td>
      <td>Major</td>
      <td>Tech08</td>
      <td>250000</td>
      <td>0.00</td>
      <td>50000.000</td>
      <td>200000.000</td>
    </tr>
    <tr>
      <th>934</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/5/2013</td>
      <td>1/5/2013</td>
      <td>1/5/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1059</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/5/2013</td>
      <td>1/6/2013</td>
      <td>1/7/2013</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Medium</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/6/2013</td>
      <td>1/6/2013</td>
      <td>1/10/2013</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech14</td>
      <td>170000</td>
      <td>1158705.72</td>
      <td>265741.144</td>
      <td>1062864.576</td>
    </tr>
    <tr>
      <th>1213</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/6/2013</td>
      <td>1/6/2013</td>
      <td>1/7/2013</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>Test OK</td>
      <td>No Action</td>
      <td>Free Of Charge</td>
      <td>Tech20</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>1550</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>READ ERROR</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Medium</td>
      <td>Tech12</td>
      <td>0</td>
      <td>1158705.72</td>
      <td>231741.144</td>
      <td>826864.576</td>
    </tr>
    <tr>
      <th>1571</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>NaN</td>
      <td>ARDEBIL</td>
      <td>1/9/2013</td>
      <td>1/9/2013</td>
      <td>1/27/2013</td>
      <td>0</td>
      <td>18</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech18</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>1617</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>NaN</td>
      <td>Tehran</td>
      <td>1/9/2013</td>
      <td>1/10/2013</td>
      <td>1/13/2013</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>DEFORMED</td>
      <td>NO POWER</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech08</td>
      <td>250000</td>
      <td>0.00</td>
      <td>50000.000</td>
      <td>200000.000</td>
    </tr>
  </tbody>
</table>
</div>



based on the task you about to do with data after the data is prepared, decide how much droping rows is logical. if 10 rows is not a lot, we can drop them.


```python
service_df.dropna(inplace=True)
```

what cities are in the dataset?


```python
print(sorted(service_df.City.unique()))
```

    ['ABADAN', 'ABHAR', 'AHVAZ', 'AMOL', 'ARAK', 'ARDEBI', 'ARDEBIL', 'BABOL', 'BABOLSAR', 'BANDAR ABBAS', 'BANDAR ANZALI', 'BANDARABBAS', 'BARDSIR', 'BEHBAHAN', 'BIJAR', 'BIRJAND', 'BOJNORD', 'BOKAN', 'BOMEHEN', 'BOROJERD', 'CHABAHAR', 'CHALOOS', 'CHALOUS', 'CHENARAN', 'DEZFOL', 'DEZFOUL', 'DOROD', 'ESFAHAN', 'ESFAHN', 'ESFERAYN', 'ESLAM ABAD', 'ESLAM SHAHR', 'ESLAMSHAHR', 'FARDIS', 'FARHANG', 'GARMSAR', 'GHAEM SHAHR', 'GHAEMSHAHR', 'GHARCHAK', 'GOLPAYGAN', 'GONBAD', 'GONBAD KAVOS', 'GORGAN', 'HAMEDAN', 'HASHTGERD', 'HSMEDAN', 'ILAM', 'IZEH', 'JAHROM', 'JEYROFT', 'KARAJ', 'KASHAN', 'KASHMAR', 'KERMAN', 'KERMANSHAH', 'KHOMAM', 'KHOMEIN', 'KHORAM ABAD', 'KHOY', 'KhoramAbad', 'LAHIJAN', 'LANGEROD', 'LANGEROOD', 'MAHMOUD ABAD', 'MAHSHAHR', 'MALAYER', 'MANJIL', 'MASHHAD', 'MEHRSHAHR', 'MIYANEH', 'NAHAVAND', 'NIYSHABOUR', 'NOR', 'NOSHAHR', 'NOUR', 'NOUSHAHR', 'OROMIYEH', 'PARS ABAD', 'QAZVIN', 'QOM', 'RAFSANJAN', 'RASHT', 'REZVANSHAHR', 'ROBAT KARIM', 'ROBATKARIM', 'RODSAR', 'SABZEVAR', 'SALMAS', 'SARAF ZADEH', 'SARBANDAR', 'SARI', 'SAVAD KOOH', 'SAVEH', 'SAVOJBOLAGH', 'SEMNAN', 'SHAHR GHODS', 'SHAHRE GHODS', 'SHAHRE KORD', 'SHAHRGHODS', 'SHAHROD', 'SHAHROOD', 'SHAHRYAR', 'SHAZAND', 'SHIRAZ', 'SIRJAN', 'TABAS', 'TABRIZ', 'TALESH', 'TEHRAN', 'TONEKABON', 'Tehran', 'VARAMIN', 'YAZD', 'ZAHEDAN', 'ZANJAN']


Look at the values above, what you see? we have multiple ways of writing same city name. 

* 'ARDEBI',                 'ARDEBIL'
* 'BANDAR ABBAS',           'BANDARABBAS'
* 'CHALOOS',                'CHALOUS'
* 'DEZFOL',                 'DEZFOUL'
* 'ESFAHAN',                'ESFAHN'
* 'ESLAMSHAHR',             'ESLAM SHAHR'
* 'GHAEM SHAHR',            'GHAEMSHAHR'
* 'HAMEDAN',                'HSMEDAN'
* 'KHORAM ABAD',            'KhoramAbad'
* 'LANGEROD',               'LANGEROOD'
* 'NOR',                    'NOUR'
* 'NOSHAHR',                'NOUSHAHR'
* 'ROBAT KARIM',            'ROBATKARIM'
* 'SHAHR GHODS',            'SHAHRE GHODS', 'SHAHRGHODS'
* 'SHAHROD',                'SHAHROOD'
* 'TEHRAN',                 'Tehran'

so we should transform them into a common format. it's a Data standardization.


```python
city_dictionary = {'ARDEBIL': 'ARDEBI', 'BANDARABBAS': 'BANDAR ABBAS', 'CHALOUS': 'CHALOOS', 'DEZFOUL': 'DEZFOL', 'ESFAHN':  'ESFAHAN', 'ESLAM SHAHR': 'ESLAMSHAHR', 'GHAEMSHAHR': 'GHAEM SHAHR', 'HAMEDAN': 'HSMEDAN', 'KhoramAbad':  'KHORAM ABAD', 'LANGEROOD': 'LANGEROD', 'NOUR': 'NOR', 'NOUSHAHR': 'NOSHAHR', 'ROBATKARIM': 'ROBAT KARIM','SHAHRE GHODS': 'SHAHR GHODS', 'SHAHRGHODS': 'SHAHR GHODS', 'SHAHROOD': 'SHAHROD', 'Tehran': 'TEHRAN'}
service_df = service_df.replace({'City': city_dictionary})
```

Now let's check if dataframe have duplicate rows or not.


```python
service_df.duplicated().any()
```




    True



unfortunately, it does. since we're looking at the dataframe as [Analytical base table(ABT)](https://en.wikipedia.org/wiki/Analytical_base_table), it's better to drop them.


```python
service_df.drop_duplicates(inplace=True)
service_df.shape
```




    (1971, 19)



let's look again at dtypes. we can convert them into more sufficent types.


```python
service_df.dtypes
```




    Service_type              int64
    Cost_Type                object
    Product_Group            object
    City                     object
    Receipt_Date             object
    Appoint_Date             object
    Complete_Date            object
    TAT01                     int64
    TAT02                     int64
    Job_Satus                 int64
    Defect_Des               object
    Symptom_Desc             object
    Repair_Action_Desc       object
    Labor_Charge_Desc        object
    Engineer                 object
    Labor_Charge_Amount       int64
    Parts_Amount            float64
    Discount_Amount         float64
    Total_Invoice_Amount    float64
    dtype: object



*```Receipt_Date```*, *```Appoint_Date```* and *```Complete_Date```* elements are object, let's convert them to datetime type.
Remember that we have explored the data. so we know data is using this (%m/%d/%Y) time format.


```python
service_df[["Receipt_Date", "Appoint_Date", "Complete_Date"]] = service_df[["Receipt_Date", "Appoint_Date", "Complete_Date"]].apply(lambda _: pd.to_datetime(_, format='%m/%d/%Y'))
```

Now let's see all values for each column with object dtype


```python
for column in service_df.select_dtypes(include=[object]).columns:
    print(column, sorted(service_df[column].unique()), sep="\n\t")
    print("-------------------------")
```

    Cost_Type
    	['Extended Warranty', 'Normal Warranty', 'Out of Warranty']
    -------------------------
    Product_Group
    	['AIR CONDITIONER ', 'AUDIO - HOME THEAT', 'AUDIO - MP3 Player', 'CAMCORDER', 'DIGITAL CAMERA', 'DVD PLAYER', 'DVD PLAYER/ RECORD', 'HARD DISK DRIVE', 'LCD- 46', 'LCD-40', 'LED40', 'LED46', 'LED55', 'MONITOR - TFT LCD ', 'OVEN - MICROWAVE', 'PLASMA-42', 'PLASMA-43', 'PLASMA-50', 'PLASMA-51', 'PRINTER - COLOR LA', 'PRINTER - MONO LAS', 'REFRIGERATOR-SBS', 'TFT18', 'VACUUM CLEANER', 'WASHING MACHINE']
    -------------------------
    City
    	['ABADAN', 'ABHAR', 'AHVAZ', 'AMOL', 'ARAK', 'ARDEBI', 'BABOL', 'BABOLSAR', 'BANDAR ABBAS', 'BANDAR ANZALI', 'BARDSIR', 'BEHBAHAN', 'BIJAR', 'BIRJAND', 'BOJNORD', 'BOKAN', 'BOMEHEN', 'BOROJERD', 'CHABAHAR', 'CHALOOS', 'CHENARAN', 'DEZFOL', 'DOROD', 'ESFAHAN', 'ESFERAYN', 'ESLAM ABAD', 'ESLAMSHAHR', 'FARDIS', 'FARHANG', 'GARMSAR', 'GHAEM SHAHR', 'GHARCHAK', 'GOLPAYGAN', 'GONBAD', 'GONBAD KAVOS', 'GORGAN', 'HASHTGERD', 'HSMEDAN', 'ILAM', 'IZEH', 'JAHROM', 'JEYROFT', 'KARAJ', 'KASHAN', 'KASHMAR', 'KERMAN', 'KERMANSHAH', 'KHOMAM', 'KHOMEIN', 'KHORAM ABAD', 'KHOY', 'LAHIJAN', 'LANGEROD', 'MAHMOUD ABAD', 'MAHSHAHR', 'MALAYER', 'MANJIL', 'MASHHAD', 'MEHRSHAHR', 'MIYANEH', 'NAHAVAND', 'NIYSHABOUR', 'NOR', 'NOSHAHR', 'OROMIYEH', 'PARS ABAD', 'QAZVIN', 'QOM', 'RAFSANJAN', 'RASHT', 'REZVANSHAHR', 'ROBAT KARIM', 'RODSAR', 'SABZEVAR', 'SALMAS', 'SARAF ZADEH', 'SARBANDAR', 'SARI', 'SAVAD KOOH', 'SAVEH', 'SAVOJBOLAGH', 'SEMNAN', 'SHAHR GHODS', 'SHAHRE KORD', 'SHAHROD', 'SHAHRYAR', 'SHAZAND', 'SHIRAZ', 'SIRJAN', 'TABAS', 'TABRIZ', 'TALESH', 'TEHRAN', 'TONEKABON', 'VARAMIN', 'YAZD', 'ZAHEDAN', 'ZANJAN']
    -------------------------
    Defect_Des
    	['COLD SOLDER', 'DEFORMED', 'DIRTY', 'DRY', 'LEAKING', 'OPEN', 'SHORT', 'Software Bug', 'WORN-OUT', 'WRONG PARTS']
    -------------------------
    Symptom_Desc
    	['BEATING ON PICTURE', 'BUTTON/DIAL NOT WORKING', 'Broken External Flash', 'Cosmetic replacement(customer request)', 'DISPLAY DIM', 'Defective Date Mode', 'Defective Eye Cup', 'Defective LCD Touch Screen', 'Defective Usb Cable', 'EXCESSIVE COLOR', 'Exterior Problem/damage', 'FAULTY COUNTER/TIMER', 'FAULTY OSD', 'FIRMWARE UPAGRADE REQUESTED', 'HORIZONTAL LINE PRINTED', 'MEMORY ERASED/MISSED', 'NO AUDIO', 'NO LOADING', 'NO PICTURE/NO RASTER', 'NO POWER', 'No Power', 'OTHER FAULTY INDICATION', 'OTHER PROBLEMS', 'OUTCASE CRACK', 'PICTURE SLIDING', 'PICTURE TOO BRIGHT', 'PICTURE TOO DARK', 'PIXEL MISSING', 'POOR FOCUS', 'POWER OFF NOT WORKING', 'POWER ON, BUT NO OPERATION', 'Power On, But No Operation', 'READ ERROR', 'RESET NOT WORKING', 'SHORT BATTERY CHARGING', 'SHORT BATTERY LIFE', 'SNOWY PICTURE', 'SOUND CLIPPING', 'Test OK', 'UNIT AUTO-OFF', 'VERTICAL LINE PRINTED']
    -------------------------
    Repair_Action_Desc
    	['ADJUSTMENT', 'CHANGE LCD', 'CHANGE OUTCASE', 'CLEANING', 'Cosmetic replacement(customer request)', "DECK ASS'Y REPAIR/REPLACEMENT", 'DECK CLEANING', 'ELECTRICAL PARTS REPLACEMENT', 'FIRMWARE UPGRADE', 'HEAD CLEANING', 'MECHANICAL PARTS REPLACEMENT', 'MECHANICAL RE-ASSEMBLING', 'No Action', 'OTHER CLEANING', 'OTHER ELECTRICAL ADJUSTMENT', 'OTHER MECHANICAL ADJUSTMENT', 'OTHER REPAIR', 'PARTS REMOVAL', 'PCB REPLACEMENT', 'PICKUP CLEANING', 'REPAIR REFUSAL', 'SCRAP', 'SET EXCHANGE', 'SOFTWARE UPGRADE', 'SOLDERING', 'TELECOM CARRIER PROBLEM']
    -------------------------
    Labor_Charge_Desc
    	['Free Of Charge', 'Major', 'Maximum', 'Medium', 'Minimum', 'Minor']
    -------------------------
    Engineer
    	['Tech01', 'Tech02', 'Tech03', 'Tech04', 'Tech05', 'Tech06', 'Tech07', 'Tech08', 'Tech10', 'Tech11', 'Tech12', 'Tech13', 'Tech14', 'Tech15', 'Tech16', 'Tech17', 'Tech18', 'Tech20', 'Tech21', 'Tech22', 'Tech23', 'Tech24']
    -------------------------


it seems all columns with object dtype can be seen as category type.


```python
for column in service_df.select_dtypes(include=[object]).columns:
    service_df[column] = service_df[column].astype('category')
```

Now let's see all values for each column with integer dtype


```python
for column in service_df.select_dtypes(include=['int64']).columns:
    print(column, sorted(service_df[column].unique()), sep="\n\t")
    print("-------------------------")
```

    Service_type
    	[0, 1]
    -------------------------
    TAT01
    	[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 30, 31, 32, 33, 34, 36, 37, 38, 40, 42, 44, 50, 54, 55, 58, 64, 65, 67, 68, 81]
    -------------------------
    TAT02
    	[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 47, 48, 50, 51, 52, 54, 56, 58, 60, 65, 68, 73, 75, 77, 78, 80, 81, 82, 84, 87, 88, 105, 122, 135, 153, 158, 208, 351]
    -------------------------
    Job_Satus
    	[0, 1]
    -------------------------
    Labor_Charge_Amount
    	[0, 50000, 70000, 85000, 120000, 145000, 150000, 170000, 180000, 200000, 215000, 240000, 250000, 300000, 350000, 360000, 400000, 420000, 540000]
    -------------------------


also *```Service_type```* and *```Job_Satus```* can be seen as categorical data type.


```python
service_df['Service_type'] = service_df['Service_type'].astype('category')
service_df['Job_Satus'] = service_df['Job_Satus'].astype('category')
```

Scaling and Normalization

*```Labor_Charge_Amount```*, *```Parts_Amount```*, *```Discount_Amount```* and *```Total_Invoice_Amount```* values shows how big their are. we can scale them down  



```python
service_df['Labor_Charge_Amount'] = service_df['Labor_Charge_Amount'].div(1000)
service_df['Parts_Amount'] = service_df['Parts_Amount'].div(1000)
service_df['Discount_Amount'] = service_df['Discount_Amount'].div(1000)
service_df['Total_Invoice_Amount'] = service_df['Total_Invoice_Amount'].div(1000)
```


```python
service_df.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Cost_Type</th>
      <th>Product_Group</th>
      <th>City</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Normal Warranty</td>
      <td>AUDIO - HOME THEAT</td>
      <td>TEHRAN</td>
      <td>2012-02-05</td>
      <td>2012-02-05</td>
      <td>2013-01-21</td>
      <td>0</td>
      <td>351</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>TEHRAN</td>
      <td>2012-07-07</td>
      <td>2012-09-10</td>
      <td>2013-01-31</td>
      <td>65</td>
      <td>208</td>
      <td>1</td>
      <td>SHORT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0.0</td>
      <td>3437.48160</td>
      <td>687.486320</td>
      <td>2748.885280</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Normal Warranty</td>
      <td>REFRIGERATOR-SBS</td>
      <td>TEHRAN</td>
      <td>2012-07-07</td>
      <td>2012-08-15</td>
      <td>2013-01-31</td>
      <td>38</td>
      <td>208</td>
      <td>1</td>
      <td>OPEN</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0.0</td>
      <td>4228.75656</td>
      <td>845.751312</td>
      <td>3383.005248</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>MONITOR - TFT LCD</td>
      <td>TEHRAN</td>
      <td>2012-08-07</td>
      <td>2012-08-07</td>
      <td>2013-01-13</td>
      <td>0</td>
      <td>158</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Out of Warranty</td>
      <td>AUDIO - MP3 Player</td>
      <td>TEHRAN</td>
      <td>2012-08-07</td>
      <td>2012-08-09</td>
      <td>2013-01-07</td>
      <td>2</td>
      <td>153</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Medium</td>
      <td>Tech07</td>
      <td>120.0</td>
      <td>765.48860</td>
      <td>177.087820</td>
      <td>708.381680</td>
    </tr>
  </tbody>
</table>
</div>



Dummy variables

how about [Regression](https://en.wikipedia.org/wiki/Regression_analysis) model? but all variables should be numerical whereas dataframe have some columns with categorical type.

to address, An indicator variable rendered as a numerical variable can be used to label categorical variables.



```python
dummy_variable_cost_type = pd.get_dummies(service_df["Cost_Type"])
dummy_variable_cost_type
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Extended Warranty</th>
      <th>Normal Warranty</th>
      <th>Out of Warranty</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3132</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3133</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3134</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3135</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3136</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1971 rows × 3 columns</p>
</div>



as you can see, there's only one cell in each row with value one. 

### Merging Datasets

so we have the *service_df* Dataframe and *dummy_variable_cost_type* Dataframe. we want to merge them into one Dataframe. in this case we append columns from *dummy_variable_cost_type* into *service_df*.

this [link](https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html) is a comprehensive description to merging



```python
service_df = pd.concat([service_df, dummy_variable_cost_type], axis=1)
```

Droping original "Cost_Type" column since it's redundant.


```python
service_df.drop('Cost_Type', axis = 1, inplace=True)
service_df
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Service_type</th>
      <th>Product_Group</th>
      <th>City</th>
      <th>Receipt_Date</th>
      <th>Appoint_Date</th>
      <th>Complete_Date</th>
      <th>TAT01</th>
      <th>TAT02</th>
      <th>Job_Satus</th>
      <th>Defect_Des</th>
      <th>Symptom_Desc</th>
      <th>Repair_Action_Desc</th>
      <th>Labor_Charge_Desc</th>
      <th>Engineer</th>
      <th>Labor_Charge_Amount</th>
      <th>Parts_Amount</th>
      <th>Discount_Amount</th>
      <th>Total_Invoice_Amount</th>
      <th>Extended Warranty</th>
      <th>Normal Warranty</th>
      <th>Out of Warranty</th>
    </tr>
    <tr>
      <th>No</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>AUDIO - HOME THEAT</td>
      <td>TEHRAN</td>
      <td>2012-02-05</td>
      <td>2012-02-05</td>
      <td>2013-01-21</td>
      <td>0</td>
      <td>351</td>
      <td>0</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>REFRIGERATOR-SBS</td>
      <td>TEHRAN</td>
      <td>2012-07-07</td>
      <td>2012-09-10</td>
      <td>2013-01-31</td>
      <td>65</td>
      <td>208</td>
      <td>1</td>
      <td>SHORT</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0.0</td>
      <td>3437.48160</td>
      <td>687.486320</td>
      <td>2748.885280</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>REFRIGERATOR-SBS</td>
      <td>TEHRAN</td>
      <td>2012-07-07</td>
      <td>2012-08-15</td>
      <td>2013-01-31</td>
      <td>38</td>
      <td>208</td>
      <td>1</td>
      <td>OPEN</td>
      <td>OTHER PROBLEMS</td>
      <td>OTHER REPAIR</td>
      <td>Free Of Charge</td>
      <td>Tech03</td>
      <td>0.0</td>
      <td>4228.75656</td>
      <td>845.751312</td>
      <td>3383.005248</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>MONITOR - TFT LCD</td>
      <td>TEHRAN</td>
      <td>2012-08-07</td>
      <td>2012-08-07</td>
      <td>2013-01-13</td>
      <td>0</td>
      <td>158</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Free Of Charge</td>
      <td>Tech15</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>AUDIO - MP3 Player</td>
      <td>TEHRAN</td>
      <td>2012-08-07</td>
      <td>2012-08-09</td>
      <td>2013-01-07</td>
      <td>2</td>
      <td>153</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>SOFTWARE UPGRADE</td>
      <td>Medium</td>
      <td>Tech07</td>
      <td>120.0</td>
      <td>765.48860</td>
      <td>177.087820</td>
      <td>708.381680</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3132</th>
      <td>0</td>
      <td>LCD-40</td>
      <td>REZVANSHAHR</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420.0</td>
      <td>0.00000</td>
      <td>84.000000</td>
      <td>336.000000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3133</th>
      <td>0</td>
      <td>LED46</td>
      <td>ESFAHAN</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>ELECTRICAL PARTS REPLACEMENT</td>
      <td>Major</td>
      <td>Tech13</td>
      <td>420.0</td>
      <td>0.00000</td>
      <td>84.000000</td>
      <td>336.000000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3134</th>
      <td>0</td>
      <td>HARD DISK DRIVE</td>
      <td>TEHRAN</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Minimum</td>
      <td>Tech07</td>
      <td>50.0</td>
      <td>0.00000</td>
      <td>10.000000</td>
      <td>40.000000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3135</th>
      <td>0</td>
      <td>HARD DISK DRIVE</td>
      <td>TEHRAN</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>REPAIR REFUSAL</td>
      <td>Free Of Charge</td>
      <td>Tech07</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3136</th>
      <td>0</td>
      <td>DVD PLAYER/ RECORD</td>
      <td>TEHRAN</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>2013-01-31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>WORN-OUT</td>
      <td>OTHER PROBLEMS</td>
      <td>MECHANICAL PARTS REPLACEMENT</td>
      <td>Minor</td>
      <td>Tech18</td>
      <td>150.0</td>
      <td>1488.48200</td>
      <td>328.686400</td>
      <td>1318.785600</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1971 rows × 21 columns</p>
</div>



now store the prepared dataframe. and let's say you are just interested in "HARD DISK DRIVE"s. ```to_csv()``` and ``` to_pickle``` will do this.


```python
Harddrive_df = service_df.loc[service_df['Product_Group'] == 'HARD DISK DRIVE']
Harddrive_df.to_csv('Harddrive.csv') 
```



## Iran's Earthquakes through history

### Opening Excel Files
as another example. let's look at this new database


```python
earthquake_dfs = pd.read_excel(join('Datasets', 'earthquake', 'data.xls'), sheet_name=None)
earthquake_dfs.keys()
```




    dict_keys(['Historical', '1900-1963', '1964-2000'])



data is divided between three sheet. let's look at two of them.


```python
earthquake_df1 = earthquake_dfs['1900-1963']
earthquake_df1.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No.</th>
      <th>Date</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Time</th>
      <th>Location</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Magnitude</th>
      <th>Unnamed: 9</th>
      <th>Ref.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>Y</td>
      <td>M</td>
      <td>D</td>
      <td>NaN</td>
      <td>Lat.</td>
      <td>Long.</td>
      <td>Dept</td>
      <td>mb</td>
      <td>Ms</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>1900</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.5</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1900</td>
      <td>7</td>
      <td>12</td>
      <td>NaN</td>
      <td>40.28</td>
      <td>43.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.9</td>
      <td>ULM</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>1901</td>
      <td>4</td>
      <td>3</td>
      <td>57.0</td>
      <td>40</td>
      <td>44.3</td>
      <td>15</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>MEA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>1902</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
    </tr>
  </tbody>
</table>
</div>




```python
earthquake_df2 = earthquake_dfs['1964-2000']
earthquake_df2.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No.</th>
      <th>Date</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Time</th>
      <th>Location</th>
      <th>Unnamed: 6</th>
      <th>Unnamed: 7</th>
      <th>Magnitude</th>
      <th>Unnamed: 9</th>
      <th>Unnamed: 10</th>
      <th>Ref.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>Y</td>
      <td>M</td>
      <td>D</td>
      <td>NaN</td>
      <td>Lat.</td>
      <td>Long.</td>
      <td>Dept</td>
      <td>mb</td>
      <td>Ms</td>
      <td>Mw</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>1964</td>
      <td>1</td>
      <td>12</td>
      <td>124550.0</td>
      <td>31.52</td>
      <td>49.23</td>
      <td>56</td>
      <td>5.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ISC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1964</td>
      <td>1</td>
      <td>19</td>
      <td>91353.0</td>
      <td>26.79</td>
      <td>54</td>
      <td>38</td>
      <td>5.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ISC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>1964</td>
      <td>1</td>
      <td>30</td>
      <td>122310.0</td>
      <td>32.7</td>
      <td>47.8</td>
      <td>33</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>PDE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>1964</td>
      <td>2</td>
      <td>5</td>
      <td>102423.0</td>
      <td>40.37</td>
      <td>46.1</td>
      <td>9</td>
      <td>4.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ISC</td>
    </tr>
  </tbody>
</table>
</div>



second row is header too. we could have use ```header=[0, 1]``` as argument for ```csv_read``` to fix this. but now let's do it manually.


```python
earthquake_df1.columns = ['No', 'Year', 'Month', 'Day', 'Time', 'Lat', 'Long', 'Dept', 'mb', 'Ms', 'ref']
earthquake_df1 = earthquake_df1.iloc[1:].reset_index(drop=True)
earthquake_df2.columns = ['No', 'Year', 'Month', 'Day', 'Time', 'Lat', 'Long', 'Dept', 'mb', 'Ms', 'Mw', 'ref']
earthquake_df2 = earthquake_df2.iloc[1:].reset_index(drop=True)
earthquake_df1.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Dept</th>
      <th>mb</th>
      <th>Ms</th>
      <th>ref</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1900</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.5</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>1900</td>
      <td>7</td>
      <td>12</td>
      <td>NaN</td>
      <td>40.28</td>
      <td>43.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.9</td>
      <td>ULM</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1901</td>
      <td>4</td>
      <td>3</td>
      <td>57.0</td>
      <td>40</td>
      <td>44.3</td>
      <td>15</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>MEA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>1902</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1902</td>
      <td>2</td>
      <td>13</td>
      <td>93906.0</td>
      <td>40.72</td>
      <td>48.71</td>
      <td>33</td>
      <td>6</td>
      <td>NaN</td>
      <td>B77</td>
    </tr>
  </tbody>
</table>
</div>



### Concatenation
we concat these two dataframe into one. notice that how new columns are the union of two dataframes' columns.


```python
earthquake_df_all = pd.concat([earthquake_df1, earthquake_df2])
earthquake_df_all.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Dept</th>
      <th>mb</th>
      <th>Ms</th>
      <th>ref</th>
      <th>Mw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1900</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.5</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>1900</td>
      <td>7</td>
      <td>12</td>
      <td>NaN</td>
      <td>40.28</td>
      <td>43.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.9</td>
      <td>ULM</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1901</td>
      <td>4</td>
      <td>3</td>
      <td>57.0</td>
      <td>40</td>
      <td>44.3</td>
      <td>15</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>1902</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1902</td>
      <td>2</td>
      <td>13</td>
      <td>93906.0</td>
      <td>40.72</td>
      <td>48.71</td>
      <td>33</td>
      <td>6</td>
      <td>NaN</td>
      <td>B77</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Imputation
Also let's replace *`NaN`*s in *`mb` column* with mean of that column.


```python
earthquake_df_all['mb'].fillna((earthquake_df_all['mb'].mean()), inplace=True)
earthquake_df_all.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Dept</th>
      <th>mb</th>
      <th>Ms</th>
      <th>ref</th>
      <th>Mw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1900</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.5</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>4.459897</td>
      <td>5</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>1900</td>
      <td>7</td>
      <td>12</td>
      <td>NaN</td>
      <td>40.28</td>
      <td>43.1</td>
      <td>NaN</td>
      <td>4.459897</td>
      <td>5.9</td>
      <td>ULM</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1901</td>
      <td>4</td>
      <td>3</td>
      <td>57.0</td>
      <td>40</td>
      <td>44.3</td>
      <td>15</td>
      <td>4.459897</td>
      <td>3.9</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>1902</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39</td>
      <td>43.3</td>
      <td>NaN</td>
      <td>4.459897</td>
      <td>5</td>
      <td>MEA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1902</td>
      <td>2</td>
      <td>13</td>
      <td>93906.0</td>
      <td>40.72</td>
      <td>48.71</td>
      <td>33</td>
      <td>6.000000</td>
      <td>NaN</td>
      <td>B77</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



Further work can be done on this dataframe.

## Json files (Bonus)

In this part, we will use request to gather search results. 


```python
import requests
import json
```


```python
query = {'q': 'playstation 5', 'sort': 'popularity', 'size' : 50}
response = requests.get("https://api.torob.com/v4/base-product/search/", params=query)
```


```python
response_json =  response.json()
response_json.keys()
```




    dict_keys(['results', 'count', 'max_price', 'min_price', 'next', 'previous', 'spellcheck', 'available_filters', 'filter_by_category_title', 'categories', 'parent_categories'])




```python
response_df = pd.json_normalize(response_json['results'])
response_df.head()
```




<div class='table-wrapper'>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_url</th>
      <th>discount_info</th>
      <th>random_key</th>
      <th>name1</th>
      <th>name2</th>
      <th>more_info_url</th>
      <th>web_client_absolute_url</th>
      <th>price</th>
      <th>price_text</th>
      <th>price_text_mode</th>
      <th>shop_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://storage.torob.com/backend-api/base/ima...</td>
      <td>[]</td>
      <td>2e71cfe4-7b77-4e80-837b-de93b5fb95d7</td>
      <td>کنسول بازی سونی PlayStation 5 Digital پلی استی...</td>
      <td>Playstation 5 Digital Editoin</td>
      <td>https://api.torob.com/v4/base-product/details-...</td>
      <td>/p/2e71cfe4-7b77-4e80-837b-de93b5fb95d7/%DA%A9...</td>
      <td>20120000</td>
      <td>از ۲۰٫۱۲۰٫۰۰۰ تومان</td>
      <td>active</td>
      <td>در ۱۰۱ فروشگاه</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://storage.torob.com/backend-api/base/ima...</td>
      <td>[]</td>
      <td>9825c33c-07e6-4ac7-8bd6-12015ebb3e3c</td>
      <td>کنسول بازی سونی PlayStation 5 Standard  پلی اس...</td>
      <td>Playstation 5 Standard Editoin</td>
      <td>https://api.torob.com/v4/base-product/details-...</td>
      <td>/p/9825c33c-07e6-4ac7-8bd6-12015ebb3e3c/%DA%A9...</td>
      <td>21700000</td>
      <td>از ۲۱٫۷۰۰٫۰۰۰ تومان</td>
      <td>active</td>
      <td>در ۱۳۶ فروشگاه</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://pcjanebi.com/wp-content/uploads/2021/0...</td>
      <td>[]</td>
      <td>9687bb29-671b-42e4-986b-5f56ca3ade59</td>
      <td>باندل کنسول بازی سونی PlayStation 5 Standard پ...</td>
      <td>Standard PlayStation 5 bundle+DualSense+Pulse+...</td>
      <td>https://api.torob.com/v4/base-product/details-...</td>
      <td>/p/9687bb29-671b-42e4-986b-5f56ca3ade59/%D8%A8...</td>
      <td>29990000</td>
      <td>از ۲۹٫۹۹۰٫۰۰۰ تومان</td>
      <td>active</td>
      <td>در ۵ فروشگاه</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://storage.torob.com/backend-api/base/ima...</td>
      <td>[]</td>
      <td>3d19000e-b1a3-48de-8ef2-70c23c89b534</td>
      <td>پلی استیشن 5 دیجیتال به همراه بازی باندل 2 دسته</td>
      <td></td>
      <td>https://api.torob.com/v4/base-product/details-...</td>
      <td>/p/3d19000e-b1a3-48de-8ef2-70c23c89b534/%D9%BE...</td>
      <td>23000000</td>
      <td>۲۳٫۰۰۰٫۰۰۰ تومان</td>
      <td>active</td>
      <td>در مرکزخریددات کام</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://storage.torob.com/backend-api/base/ima...</td>
      <td>[]</td>
      <td>88d90bf1-b3c9-4a6f-8abc-0605f0e8a008</td>
      <td>کنسول بازی سونی پلی استیشن 5 ظرفیت 825 گیگابایت</td>
      <td></td>
      <td>https://api.torob.com/v4/base-product/details-...</td>
      <td>/p/88d90bf1-b3c9-4a6f-8abc-0605f0e8a008/%DA%A9...</td>
      <td>21299000</td>
      <td>۲۱٫۲۹۹٫۰۰۰ تومان</td>
      <td>active</td>
      <td>در ژیوان</td>
    </tr>
  </tbody>
</table>
</div>


